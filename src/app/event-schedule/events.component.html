<div class="mobile-calendar" *ngIf="currentMonth$ | async">
    <div class="calendar-header">
        <div class="title-area">
            <span class="sub-title">{{ scheduleYear }} Schedule</span>
            <h1 *ngIf="currentMonth$ | async">
                {{ (currentMonth$ | async)?.name }} {{ (currentMonth$ |
                async)?.year }}
            </h1>
        </div>
        <div class="calendar-controls">
            <button (click)="goToToday()" class="today-btn">Today</button>
            <button (click)="prevMonth()" class="nav-btn">
                <i class="fa fa-chevron-left"></i>
            </button>
            <button (click)="nextMonth()" class="nav-btn">
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </div>
    <div class="mobile-calendar-grid">
        <ng-container *ngFor="let day of weekDays">
            <div class="mobile-weekday">{{ day }}</div>
        </ng-container>

        <ng-container *ngFor="let week of (currentMonth$ | async)?.weeks">
            <ng-container *ngFor="let day of week">
                <div
                    (click)="selectDay(day)"
                    class="mobile-day"
                    [class.other-month]="!day.isCurrentMonth"
                    [class.selected-day]="selectedDay && isSameDay(day.date, selectedDay.date)"
                    [class.open-practice-day]="hasOpenPractice(day)"
                    [class.today]="day.isToday"
                    [style.opacity]="day.isCurrentMonth ? '1' : '0.5'"
                >
                    <div
                        class="mobile-day-number"
                        [class.today-number]="day.isToday"
                    >
                        {{ day.date.getDate() }}
                    </div>

                    <div
                        *ngIf="day.events.length > 0"
                        class="mobile-event-indicators"
                    >
                        <ng-container
                            *ngFor="let event of day.events | slice:0:3"
                        >
                            <div
                                class="mobile-event-dot"
                                [style.background-color]="event.isCancelled ? '#dc3545' :
                                                        (event.isOpenPractice && !event.isCancelled) ? '#28a745' :
                                                        '#007bff'"
                            ></div>
                        </ng-container>

                        <small *ngIf="day.events.length > 3"
                            >+{{ day.events.length - 3 }}</small
                        >
                    </div>
                </div>
            </ng-container>
        </ng-container>
    </div>

    <div class="mobile-event-list" *ngIf="selectedDay">
        <div class="mobile-day-title">
            {{ selectedDay.date | date:'EEEE, MMMM d' }}
        </div>

        <ng-container *ngIf="selectedDay.events.length > 0">
            <div
                *ngFor="let event of selectedDay.events"
                class="mobile-event-card"
                [style.border-left]="event.isCancelled ? '4px solid #dc3545' :
                                  (event.isOpenPractice && !event.isCancelled) ? '4px solid #28a745' :
                                  '4px solid #007bff'"
            >
                <div class="mobile-event-header">
                    <div class="mobile-event-time">
                        {{ formatTime(event.date) }}
                        <span *ngIf="event.endDate">
                            - {{ formatTime(event.endDate) }}</span
                        >
                    </div>

                    <div
                        *ngIf="event.isCancelled"
                        class="mobile-cancelled-badge"
                    >
                        CANCELLED
                    </div>
                </div>

                <div
                    class="mobile-event-title"
                    [style.text-decoration]="event.isCancelled ? 'line-through' : 'none'"
                >
                    {{ event.title }}
                </div>

                <div
                    *ngIf="event.isOpenPractice && !event.isCancelled"
                    class="mobile-event-footer"
                >
                    <a routerLink="/pricing" class="mobile-signup-button"
                        >Sign Up</a
                    >
                </div>
            </div>
        </ng-container>

        <div *ngIf="selectedDay.events.length === 0" class="no-events-message">
            No events scheduled for this day
        </div>
    </div>

    <div *ngIf="!selectedDay" class="no-day-selected-message">
        Select a day to view events
    </div>
</div>
